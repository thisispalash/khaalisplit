{% extends "base.html" %}

{% block title %}{{ group.name|default:"Group" }} â€” khaaliSplit{% endblock %}

{% block content %}
<div class="space-y-6">

  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold">{{ group.name|default:"Unnamed Group" }}</h1>
      <p class="text-sm text-foreground/50">
        {{ group.member_count }} member{{ group.member_count|pluralize }}
        &middot; Created by {{ group.creator.subname }}
      </p>
    </div>
    <div class="flex items-center gap-2">
      <a href="/settle/{{ group.group_id }}/"
        class="px-4 py-2 text-sm bg-foreground text-background rounded-md
               hover:bg-foreground/90 transition-colors">
        Settle Up
      </a>
      {% if is_member %}
      <button
        class="px-3 py-2 text-xs border border-foreground/20 text-foreground/50
               rounded-md hover:text-red-400 hover:border-red-400/30 transition-colors cursor-pointer"
        hx-post="/api/groups/{{ group.group_id }}/leave/"
        hx-confirm="Leave this group?"
        hx-target="#group-content"
        hx-swap="innerHTML"
      >
        Leave
      </button>
      {% endif %}
    </div>
  </div>

  <div id="group-content" class="grid grid-cols-1 md:grid-cols-2 gap-6">

    {# Members section #}
    <div class="space-y-3">
      <h2 class="text-sm font-medium text-foreground/60">Members</h2>
      {% include 'groups/partials/invite_form.html' %}
      <div hx-get="/api/groups/{{ group.group_id }}/members/"
        hx-trigger="load"
        hx-swap="innerHTML">
        {% include 'partials/loading.html' %}
      </div>
    </div>

    {# Balances section #}
    <div hx-get="/api/groups/{{ group.group_id }}/balances/"
      hx-trigger="load"
      hx-swap="innerHTML">
      {% include 'partials/loading.html' %}
    </div>

  </div>

  {# Expenses section #}
  <div class="space-y-3">
    <h2 class="text-sm font-medium text-foreground/60">Expenses</h2>
    <div id="expense-list"
      hx-get="/api/expenses/{{ group.group_id }}/list/"
      hx-trigger="load"
      hx-swap="innerHTML">
      {% include 'partials/loading.html' %}
    </div>
  </div>

</div>
{% endblock %}
